import subprocess

# Define the file name for the screenshot
screenshot_file = "/sdcard/screenshot.png"

# Construct the ADB command to take a screenshot
adb_command = ['adb', 'shell', 'screencap', '-p', screenshot_file]

# Execute the ADB command using subprocess
process = subprocess.Popen(adb_command, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
output, error = process.communicate()

# Check if the command was successful
if process.returncode == 0:
    # Pull the screenshot file from the device to the local machine
    adb_pull_command = ['adb', 'pull', screenshot_file]
    pull_process = subprocess.Popen(adb_pull_command, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    pull_output, pull_error = pull_process.communicate()

    # Check if the pull command was successful
    if pull_process.returncode == 0:
        print('Screenshot saved successfully.')
    else:
        print('An error occurred while saving the screenshot.')
        print('Error:', pull_error.decode('utf-8'))
else:
    print('An error occurred while taking the screenshot.')
    print('Error:', error.decode('utf-8'))